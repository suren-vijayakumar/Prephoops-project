prepHoopsApp.controller("DashboardController",["$scope","$http","$location","$modal","siteFullName","AuthService",function(t,e,a,r,s,i){t.sites=[],t.dates=[],t.feeds=[],t.totalArticles=[],t.dailyAvg=[],t.percentPaid=[],t.zeroDays=[],t.Array=[],t.arrayMin=function(t){for(var e=t.length,a=1/0;e--;)t[e]<a&&(a=t[e]);return a},t.arrayMax=function(t){for(var e=t.length,a=-(1/0);e--;)t[e]>a&&(a=t[e]);return a},t.getLastParseDate=function(){e.get("/parseRSS/getLastDate").success(function(e){t.lastParseDate=new Date(e[0].date);var a=new Date(e[0].date);t.thirtyDaysBefore=new Date(a.setDate(t.lastParseDate.getDate()-30));var r=t.lastParseDate.toISOString();t.shortFirstDateString=r.substr(0,r.indexOf("T"));var s=t.thirtyDaysBefore.toISOString();t.shortSecondDateString=s.substr(0,s.indexOf("T")),t.getThirtyDaysOfArticles(t.shortSecondDateString,t.shortFirstDateString)})},t.getLastParseDate(),t.getDayOfWeek=function(e){t.dayOfWeek=e.getDay()},t.getFeeds=function(){e.get("/network/getFeeds").success(function(e){t.feeds=e,s.set("feedsArray",e)}),t.siteName(t.feeds)},t.siteNameArray=[],t.siteName=function(e){for(var a=0;a<e.length;a++)t.siteNameArray.push(e[a].siteShortName)},t.runParse=function(){e.get("/parseRSS").success(function(t,e){})},t.logout=function(){console.log(i.getUserStatus()),i.logout().then(function(){a.path("/login")})},t.go=function(t){a.path(t),s.set("siteFullName",this.site.siteFullName)},t.getThirtyDaysOfArticles=function(a,r){e.post("/api/articleGet",[a,r]).success(function(e){t.getFeeds(),t.dates=e,t.getStats(e)})},t.getFeeds(),t.getRSS=function(a,r){var s=a.toISOString();t.shortFirstDateString=s.substr(0,s.indexOf("T"));var i=r.toISOString();t.shortSecondDateString=i.substr(0,i.indexOf("T")),s>i?alert("The start date should be earlier than the end date"):i>=s&&e.post("/api/articleGet",[t.shortFirstDateString,t.shortSecondDateString]).success(function(e){t.getFeeds(),t.dates=e,t.getStats(e)})},t.clearFields=function(){t.totalSiteArticles=0,t.totalArticles=[],t.dailyAvg=[],t.percentPaid=[],t.zeroDays=[],t.articlesPerDay=0},t.getStats=function(e){t.clearFields(),t.articlesPerDay=0;var a=0;t.articlesPerDayArray=[];for(var r=1;r<=t.feeds.length;r++){for(var s=0;s<e.length;s++){for(var i=0;i<e[s].site.length;i++)e[s].site[i].siteID===r&&(t.totalSiteArticles=t.totalSiteArticles+e[s].site[i].articles.length,0===e[s].site[i].articles.length&&a++),t.articlesPerDay=t.articlesPerDay+e[s].site[i].articles.length;t.articlesPerDayArray[s]=t.articlesPerDay,t.articlesPerDay=0}t.totalArticles.push(t.totalSiteArticles),t.dailyAvg.push(Math.floor(100*t.totalSiteArticles/e.length)/100),t.zeroDays.push(a),t.totalSiteArticles=0,a=0}},t.open=function(e,a){e.preventDefault(),e.stopPropagation(),t[a]=!0},t.status={opened:!1},t.today=function(){t.last=new Date,t.first=(new Date).setDate(t.last.getDate()-30)},t.today(),t.clear=function(){t.first=null,t.last=null},t.animationsEnabled=!0,t.openModal=function(e){t.selectedArticles=this.site.articles;r.open({animation:t.animationsEnabled,templateUrl:"/assets/views/routes/articleUrl.html",controller:"ArticleInstanceController",size:e,resolve:{selectedArticles:function(){return t.selectedArticles}}})}}]),prepHoopsApp.controller("ArticleInstanceController",["$scope","$modalInstance","selectedArticles",function(t,e,a){t.modalArticles=a,t.articleUrlArray=[],t.ok=function(){e.close()}}]);